# MetaTrader 5 Docker Setup

![Banner](https://github.com/chonguoimuon/MetaTrader5-Alpine-NoVNC/blob/main/image/your-api-domain.com.png?raw=true)

## Table of Contents

- [MetaTrader 5 Docker Setup](#metatrader-5-docker-setup)
  - [Table of Contents](#table-of-contents)
  - [Overview](#overview)
  - [Features](#features)
  - [Prerequisites](#prerequisites)
  - [Installation](#installation)
  - [Configuration](#configuration)
    - [Environment Variables](#environment-variables)
    - [Docker Compose Services](#docker-compose-services)
    - [Volumes](#volumes)
  - [Usage](#usage)
  - [Logging](#logging)
  - [Troubleshooting](#troubleshooting)
  - [Contributing](#contributing)
  - [License](#license)

## Overview

This project provides a Docker-based setup to run MetaTrader 5 (MT5) using Wine on a Debian-based environment. It leverages Traefik as a reverse proxy for managing HTTP/HTTPS traffic and ensures secure access through Let's Encrypt certificates. The setup includes VNC for remote desktop access and is configured to run as a background service with proper logging and environment management.

## Features

- **Dockerized Environment:** Simplifies deployment and management of MT5.
- **Wine Compatibility:** Runs MetaTrader 5 on a Linux-based system.
- **Traefik Integration:** Handles reverse proxying with automatic SSL certificate generation via Let's Encrypt.
- **VNC Access:** Provides remote desktop access to the MT5 application.
- **Logging:** Implements structured logging for easy monitoring and debugging.
- **Environment Configuration:** Easily manage settings using environment variables.

## Prerequisites

- **Docker:** Ensure Docker is installed on your system. [Install Docker](https://docs.docker.com/get-docker/)
- **Docker Compose:** Required for orchestrating the services. [Install Docker Compose](https://docs.docker.com/compose/install/)
- **Domain Name:** A registered domain for accessing Traefik and VNC services.
- **SSL Certificate:** Managed automatically via Let's Encrypt.

## Installation

1. **Clone the Repository**

   ```bash
   git clone https://github.com/chonguoimuon/MetaTrader5-Alpine-NoVNC.git
   cd MetaTrader5-Alpine-NoVNC
   ```

2. **Configure Environment Variables**

   Create a `.env` file based on the provided example:

   ```bash
   cp .env.example .env
   ```

   Open the `.env` file and set the necessary variables:
   ```bash
   nano .env
   ```
   
   Setup info `.env`
   ```env
	# Backend - MT5
	CUSTOM_USER=admin
	PASSWORD=1234

	# Token basic authentication REST API
	MT5_API_AUTH_TOKEN=<token ramdom>

	# Domain
	VNCDOMAIN=vnc.example.com
	APIDOMAIN=api.example.com

	CADDY_EMAIL=admin@example.com  # Replace with your actual email
   ```

3. **Build and Start the Services**

   ```bash
   docker-compose up -d
   ```

This command builds the Docker images and starts the services in detached mode.
## Configuration

### Environment Variables

- `CUSTOM_USER`: Username for accessing the MT5 service.
- `PASSWORD`: Password for the custom user.
- `VNCDOMAIN`: Domain for accessing the VNC service.
- `APIDOMAIN`: Domain for Swagger UI dashboard.
- `MT5_API_AUTH_TOKEN`: Token basic authentication REST API.
- `ACME_EMAIL`: Email address for Let's Encrypt notifications.

### Docker Compose Services

- **Caddy:** Acts as a reverse proxy with HTTPS support.
- **metatrader5_novnc:** Runs MetaTrader 5 using Wine.

### Volumes

- `./config`: Stores Wine configurations and MT5 data.
- `/etc/caddy/Caddyfile`: Persists SSL certificates generated by Let's Encrypt.

## Usage

1. **Accessing MetaTrader 5**

   Navigate to `https://vnc.example.com` in your web browser to access the VNC interface for MetaTrader 5.

2. **Swagger(REST API) Dashboard**

   Access the Swagger dashboard at `https://api.example.com/apidocs/`.


3. **Managing Services**

   - **Start Services:**

     ```bash
     docker-compose up -d
     ```

   - **Stop Services:**

     ```bash
     docker-compose down
     ```

   - **View Logs:**

     ```bash
     docker-compose logs -f
	 docker logs caddy
	 docker logs metatrader5_novnc
     ```

## Logging

The setup uses JSON-file logging with the following configuration:

- **Log Driver:** `json-file`
- **Max Size:** `1m`
- **Max File:** `1`

Logs are managed per service and can be viewed using Docker commands or integrated with external logging solutions like Promtail.

## Troubleshooting

- **Caddy Not Accessible:**

  - Ensure that ports `80` and `443` are open and not blocked by a firewall.
  - Verify that your domain DNS settings are correctly pointing to your server.

- **MT5 Not Starting:**

  - Check the logs of the `mt5` service for any installation errors.
  - Ensure that Wine dependencies are properly installed.

- **VNC Connection Issues:**
  - Confirm that the VNC service is running and accessible via the specified domain.
  - Verify network configurations and firewall settings.

## Contributing

Contributions are welcome! Please follow these steps:

1. **Fork the Repository**

2. **Create a Feature Branch**

   ```bash
   git checkout -b feature/YourFeature
   ```

3. **Commit Your Changes**

   ```bash
   git commit -m "Add Your Feature"
   ```

4. **Push to the Branch**

   ```bash
   git push origin feature/YourFeature
   ```

5. **Open a Pull Request**

## License

This project is licensed under the [MIT License](LICENSE.md).
